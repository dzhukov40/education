---
Ресурсы:

// оф сайт
- [ https://docs.fluentd.org/configuration/config-file ]
 


---
элементы документа 

[?] - информация потенциально для многократного использования
[!] - была ошибка, недочет, нашли решение 
[*] - важное контекстное примечание 
[#<имяТега>] - так можим выносить различного рода информацию, оставляя ссылку 

---
краткое описание 

- [ fluentd ] позволяет получать сообщения из разных источников обрабатывать/фильтровать и отправлять потребителям.
  Это многоплатформенный инструмент пересылки логов с открытым исходным кодом, 
  который призван стать универсальным швейцарским ножом для сбора и распространения логов.


1) устанавливаем
  - есть несколько вариантов
    - [ docker ] [ https://docs.fluentd.org/configuration/config-file#docker ]
      - запустим "fluentd" 
      - [ docker run -ti --rm -v /path/to/dir:/fluentd/etc fluentd -c /fluentd/etc/<conf-file> ]  (!!!)


2) Основные части conf файла (Директивы/Directives)
  - [ source ] источник поступающих данных
  - [ match ] маршрутизация данных (можно строить pipelines обработки данных)
  - [ filter ] модификация данных
  - [ system ] системные параметры параметры, общие для всех pipelines
  - [ label ] метки для даршрутизации данных в pipelines
  - [ @include ] включение других файлов
    - https://docs.fluentd.org/configuration/config-file#share-the-same-parameters
  

3) Роутинг
  - [ tag ] метка, позволяющая маршрутизировать сообщения
    - [ https://github.com/fluent/fluent-plugin-rewrite-tag-filter ]
    - используется в <match>, <filter>
      пример: <match tort.log>
    - выражения для меток:
      - [ https://docs.fluentd.org/configuration/config-file#wildcards-expansions-and-other-tips ]
      - [ * ] совпадение части один раз
      - [ ** ] совпадение части ноль или много раз
      - [ {X,Y,Z} ] указание ИЛИ в части выражения
      - [ /regular expression/ ] регулярное выражение
      - [ #{...} ] можно использовать выражение на Ruby
      - [ через пробел указать несколько тегов]
  - [ rewrite_tag_filter ]

 
4) Output Plugins
  - [ rewrite_tag_filter ] плагин позволяет переписать тег (tag)

5) Ротация логов (log rotation)
  - в fluentd можно включить ротацию логов при помощи ключей
  - [ https://docs.fluentd.org/deployment/logging#output-to-log-file ]  
    - видим два параметра 
      - [ --log-rotate-age AGE ] определяет время хранения, 
        может быть время файла или общее колличество файлов.
      - [ --log-rotate-size BYTES ] определяет максимальный размер файла лога
    - [ fluentd  --log-rotate-age 5  --log-rotate-size 10485760 ] 
      пример хранить одновременно не больше 5 файлов, 
      переключаться на новый файл если размер привысил 10485760 байт
    






[?] nop
  - nop

 
// #
#----------------------------------------------- 


#----------------------------------------------- 
 
