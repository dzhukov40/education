---
Ресурсы:

// оф сайт
- [ https://helm.sh/ ]
 


---
элементы документа 

[?] - информация потенциально для многократного использования
[!] - была ошибка, недочет, нашли решение 
[*] - важное контекстное примечание 
[#<имяТега>] - так можим выносить различного рода информацию, оставляя ссылку 

---
краткое описание 

- [ helm ] это пакетный менеджер для kubernetes.
Основные фишки это версионирование и шаблон. 
Есть репозиторий, в котором будет храниться HELM версия артифакта.




1) Устанавливаем на mac
  - [ https://helm.sh/docs/intro/install/ ]
  - [ brew install helm ] ставим через пакетный менеджер


1a) Устанавливаем на Linux
  - [ https://helm.sh/docs/intro/install/ ] 
    - [ curl https://baltocdn.com/helm/signing.asc | sudo apt-key add - ]
    - [ sudo apt-get install apt-transport-https --yes
    - [ echo "deb https://baltocdn.com/helm/stable/debian/ all main" | sudo tee /etc/apt/sources.list.d/helm-stable-debian.list ]
    - [ sudo apt-get update && sudo apt-get install helm -y ]


2) Обшие данные
  - [ Helm ] инструмент, который работает с чартами.
    - (*) чарты могут иметь вложенные чарты
  - [ Chart.yaml ] 
  - мы удобно можем делать шаблон конфигурации депроймента


3) Чарт (Chart.yaml)
  - [ https://helm.sh/docs/topics/charts/ ]
  - формат:
    - [ apiVersion ] указываем версию апи чартов (во всех чартах ставим 2)
    - [ name ] имя чарта
    - [ version ] это уже версия нашего чарта (повышаем при апдейтах)


4) Тестирование (по сути это хук "test")
  - можно создать в чарте в папке [ templates ] папку [ test ]
    положить туда какой нибудь [ Job ] 
    - (*) манифесты должны содежать аннотацию [ helm.sh/hook: test ]
  - после того как накатили релиз можем запустить тесты [ helm test <release name> ]


5) Хуки
  - [ https://helm.sh/docs/topics/charts_hooks/ ]
  - актуальный список хуков:
    - [ pre-install,  pre-delete,  pre-upgrade,  pre-rollback ]
    - [ post-install, post-delete, post-upgrade, post-rollback ]
    - [ test ]
  - у "хуков" можно задать вес, чтобы определить порядок выполнения
  - (*) хуки не входят в релиз
  - надо положить в папку [ crds ]






[?] как проверить деплой хельмом
  - [ --dry-run ] флаг позволяет посмотреть накатятся ли наши чарты
  - [ --debug -v=8 ] флаг позволит увидеть отладочную информацию
  - [ helm template ] команда позволяет сделать из чарта 
    и всех вложенных чартов один манифест

[?] nop
  - nop

 
 
// #c 
#----------------------------------------------- 

 

#----------------------------------------------- 
 
